# @package model
name: presage
type: docker
description: "PRESAGE gene embedding-based perturbation prediction"

docker:
  image: "cellsimbench/presage:latest"
  memory: "max"
  cpus: "max"
  gpu: true
  shm_size: "16g"

# Model hyperparameters (optimal configuration from paper)
hyperparameters:
  # Core architecture
  item_hidden_size: 512
  item_nlayers: 0  # Number of layers in item network (0 = single linear layer)
  pathway_item_hidden_size: 128
  pathway_item_nlayers: 2
  
  # Pooling strategy (best performing: GAT pooling)
  pathway_pool_type: "sum"
  pathway_weight_type: "gat"
  pool_nlayers: 2
  softmax_temperature: 0.15
  gat_weight: 0.85
  
  # Training parameters
  max_epochs: 1000
  batch_size: 32
  seed: 42

  # Loss configuration (focus on core objectives)
  # Actually, none of the losses except MSE are used in code
  # Why are these hyperparameters in the original PRESAGE config?
  mse_loss_scale: 1.0
  cosine_loss_scale: 1.0
  vector_norm_loss_scale: 1.0
  added_singles_loss_scale: 1.0
  
  # Embedding parameters
  n_nmf_embedding: 128
  
  # Node2Vec parameters for co-expression/co-perturbation embeddings
  node2vec_walk_length: 100
  node2vec_context_size: 5
  node2vec_walks_per_node: 3
  node2vec_num_negative_samples: 3
  node2vec_p: 1.0
  node2vec_q: 2.0 

  perts_as_delta_ref: false
